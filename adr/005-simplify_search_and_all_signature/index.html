
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Lyz">
      
      
        <link rel="canonical" href="https://lyz-code.github.io/repository-orm/adr/005-simplify_search_and_all_signature/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>005: Simplify search and all signature - Repository ORM</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../stylesheets/links.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="light-blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#status" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Repository ORM" class="md-header__button md-logo" aria-label="Repository ORM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Repository ORM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              005: Simplify search and all signature
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/lyz-code/repository-orm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lyz-code/repository-orm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Repository ORM" class="md-nav__button md-logo" aria-label="Repository ORM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Repository ORM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/lyz-code/repository-orm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lyz-code/repository-orm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Repository ORM
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../repositories/">Repositories</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Repositories" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Repositories
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../fake_repository/" class="md-nav__link">
        FakeRepository
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tinydb_repository/" class="md-nav__link">
        TinyDBRepository
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pypika_repository/" class="md-nav__link">
        PypikaRepository
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../file_repositories/">File Repositories</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="File Repositories" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          File Repositories
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../local_file_repository/" class="md-nav__link">
        LocalFileRepository
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../models/" class="md-nav__link">
        Models
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="API Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference_adapters/" class="md-nav__link">
        Repository Implementations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference_models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference_exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../contributing/">Contributing</a>
          
            <label for="__nav_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../new_repo/" class="md-nav__link">
        Create new repository
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../adr/">Architecture Decision Records</a>
          
            <label for="__nav_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Architecture Decision Records" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Architecture Decision Records
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../001-entity_id_definition/" class="md-nav__link">
        001: Entity id_ definition
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../002-support_string_ids/" class="md-nav__link">
        002: String id_ support
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../003-make_entity_models_optional_arguments/" class="md-nav__link">
        003: Make entity_models optional arguments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../004-add_complex_queries/" class="md-nav__link">
        004: Add complex queries
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          005: Simplify search and all signature
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        005: Simplify search and all signature
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    Status
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposals" class="md-nav__link">
    Proposals
  </a>
  
    <nav class="md-nav" aria-label="Proposals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#return-a-list-instead-of-exception" class="md-nav__link">
    Return a list instead of exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-allow-one-model-in-search-and-all" class="md-nav__link">
    Only allow one model in search and all
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-allow-one-model-in-get" class="md-nav__link">
    Only allow one model in get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leave-last-and-first-as-they-are" class="md-nav__link">
    Leave last and first as they are
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decision" class="md-nav__link">
    Decision
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consequences" class="md-nav__link">
    Consequences
  </a>
  
    <nav class="md-nav" aria-label="Consequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav" aria-label="Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-2022-06-10" class="md-nav__link">
    On 2022-06-10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-2022-12-10" class="md-nav__link">
    On 2022-12-10
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../006-drop_again_string_ids/" class="md-nav__link">
        006: Drop support for string IDs
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    Status
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    Context
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposals" class="md-nav__link">
    Proposals
  </a>
  
    <nav class="md-nav" aria-label="Proposals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#return-a-list-instead-of-exception" class="md-nav__link">
    Return a list instead of exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-allow-one-model-in-search-and-all" class="md-nav__link">
    Only allow one model in search and all
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#only-allow-one-model-in-get" class="md-nav__link">
    Only allow one model in get
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leave-last-and-first-as-they-are" class="md-nav__link">
    Leave last and first as they are
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decision" class="md-nav__link">
    Decision
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consequences" class="md-nav__link">
    Consequences
  </a>
  
    <nav class="md-nav" aria-label="Consequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementation
  </a>
  
    <nav class="md-nav" aria-label="Implementation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#on-2022-06-10" class="md-nav__link">
    On 2022-06-10
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-2022-12-10" class="md-nav__link">
    On 2022-12-10
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/lyz-code/repository-orm/edit/master/docs/adr/005-simplify_search_and_all_signature.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



  <h1>005: Simplify search and all signature</h1>

<h2 id="status">Status<a class="headerlink" href="#status" title="Permanent link">&para;</a></h2>
<!-- What is the status? Draft, Proposed, Accepted, Rejected, Deprecated or Superseded?
-->
<p>Accepted</p>
<h2 id="context">Context<a class="headerlink" href="#context" title="Permanent link">&para;</a></h2>
<!-- What is the issue that we're seeing that is motivating this decision or change? -->
<p>Right now we raise an <code>EntityNotFoundError</code> exception if <code>search</code>
returns no results, which forces the user to catch this exception when it makes
more sense to return an empty list as these methods are usually used on loops.</p>
<p>We're also having some issues with the types of the return values of these
methods as we allowed them to be of type <code>Union[Type[Entity],
List[Type[Entity]], None]</code> since
<a href="../003-make_entity_models_optional_arguments/">003</a>, both when writing the code
as the type hints are difficult to write and debug and also when doing
operations on the returned objects, as the returned list contains objects with
different models that as they have different attributes and objects they need to
be dealt differently. This last point means that the user has to split the
results using <code>isinstance</code> at some point.</p>
<p>Using many models in <code>get</code> is only a good idea when you're sure that id's are
unique across all models, that way you can do <code>repo.get(id, models)</code> and get the
only entity that matches, when we initialized the repository with the available
models, you could go even further and only use <code>repo.get(id)</code>. This has the next
disadvantages:</p>
<ul>
<li>The current code requires that each repository needs to implement the logic
    of:<ul>
<li>Dealing with many models, which we want to remove. It could be delegated
    to <code>get</code> at <code>abstract.py</code> level and make <code>_get</code> only accept one model.</li>
<li>What happens when more than one entity is found. This could be mitigated if
    we change the signature of <code>_get</code> to always return a <code>List[Entity]</code> and do
    the checking at <code>get</code> level in <code>abstract.py</code>.</li>
</ul>
</li>
<li>You don't know the type of the returned object at type checker level. It's
    a nuisance but not critical, as it should be acceptable if you're using
    <code>get</code> this way.</li>
</ul>
<p>The <code>last</code> and <code>first</code> methods are used over the <code>all</code> method not over the
<code>search</code> which would be useful too.</p>
<h2 id="proposals">Proposals<a class="headerlink" href="#proposals" title="Permanent link">&para;</a></h2>
<!-- What are the possible solutions to the problem described in the context -->

<h3 id="return-a-list-instead-of-exception">Return a list instead of exception<a class="headerlink" href="#return-a-list-instead-of-exception" title="Permanent link">&para;</a></h3>
<p><code>search</code> will return an empty list if there are no results instead of
an <code>EntityNotFoundError</code> exception.</p>
<h3 id="only-allow-one-model-in-search-and-all">Only allow one model in search and all<a class="headerlink" href="#only-allow-one-model-in-search-and-all" title="Permanent link">&para;</a></h3>
<p>We could revert <a href="../003-make_entity_models_optional_arguments/">003</a> and only
allow one model in <code>search</code> and <code>all</code> but that will mean that the context of
that ADR won't be met anymore which was that some applications need to do
operations on all or a subset of entity types. They will then be forced to run
the desired method once for each entity type which has the next disadvantages:</p>
<ul>
<li>
<p>The user has to write more code. Which may not true, as even though you
    have to run <code>repo.search</code> and <code>repo.all</code> more than once, right now you also
    have to write additional code to tell apart the returned objects. This last
    statement may not be true if the user has asked for a group of entities that
    share some common attributes with whom it wants to work with.</p>
<p>After migrating some code I've seen that at user level the change is from:</p>
<div class="highlight"><pre><span></span><code><span class="n">active_resources</span> <span class="o">=</span> <span class="n">repo</span><span class="o">.</span><span class="n">search</span><span class="p">({</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">},</span> <span class="n">models</span><span class="p">)</span>
</code></pre></div>
<p>To:</p>
<div class="highlight"><pre><span></span><code><span class="n">active_resources</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">entity</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span> <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">search</span><span class="p">({</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;active&quot;</span><span class="p">},</span> <span class="n">model</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
<p>Which I think it's assumable given that it can be considered a corner case.</p>
</li>
<li>
<p>Instead of running everything on a query, many will be done. The potential
    downside of that is performance loss, but in reality:</p>
<ul>
<li>The pypika and fake repos are already doing many queries.</li>
<li>The tinydb repo is doing everything in one query but then from the
    gathered data it has to go model by model building the ones that match.</li>
</ul>
<p>So probably we won't have any performance loss.</p>
</li>
</ul>
<p>And the next advantages:</p>
<ul>
<li>We've introduced a great deal of complexity on
    <a href="../003-make_entity_models_optional_arguments/">003</a> both on functions and
    type hints, removing them will improve maintainability and peace of mind
    when coding.</li>
</ul>
<h3 id="only-allow-one-model-in-get">Only allow one model in get<a class="headerlink" href="#only-allow-one-model-in-get" title="Permanent link">&para;</a></h3>
<p>If we only allow one model in <code>get</code> we'll remove complexity in terms of:</p>
<ul>
<li>No need to loop over the models.</li>
</ul>
<p>The management of the case of more than one entity found has to be still
managed, as we can only enforce this case in pypika, fake and tinydb doesn't
have that kind of constrain at database level.</p>
<p>The case that it makes sense to keep the feature is a corner case as most of
databases use integer ids. And if you've made the ids unique between
models it should be straight forward to make a function that gives you the model
for that ID, or you're free to iterate over the models and suppress the
<code>EntityNotFoundError</code> exception.</p>
<p>Therefore it makes no sense to keep complexity for a corner case.</p>
<h3 id="leave-last-and-first-as-they-are">Leave last and first as they are<a class="headerlink" href="#leave-last-and-first-as-they-are" title="Permanent link">&para;</a></h3>
<p>Even though it's true that they could be used on the <code>search</code> result, let's be
honest, using <code>[0]</code> and <code>[-1]</code> is not that difficult, and if there are no
elements it will return an <code>IndexError</code> a common used exception. As <code>first</code> and
<code>last</code> are already coded and it's easy to maintain I'll leave them as they are
and assume that <code>search</code> won't have them.</p>
<p>After a deeper analysis, <code>last</code> and <code>fist</code> take into account both staged and
stored entities, so it's not equal to <code>[0]</code> and <code>[-1]</code>.</p>
<h2 id="decision">Decision<a class="headerlink" href="#decision" title="Permanent link">&para;</a></h2>
<!-- What is the change that we're proposing and/or doing? -->

<ul>
<li>Revert the changes of <a href="../003-make_entity_models_optional_arguments/">003</a>.</li>
<li><code>search</code> will return an empty list if there are no results instead of
    an <code>EntityNotFoundError</code> exception.</li>
</ul>
<h2 id="consequences">Consequences<a class="headerlink" href="#consequences" title="Permanent link">&para;</a></h2>
<!-- What becomes easier or more difficult to do because of this change? -->

<p>Pros:</p>
<ul>
<li>
<p>More maintainable code.</p>
<ul>
<li>Less complexity in the data adapters.</li>
<li>Less problems with the type hints.</li>
</ul>
</li>
<li>
<p>Remove the model conflicts of <code>get</code></p>
</li>
</ul>
<p>Cons:</p>
<ul>
<li>Users will need to update their code as the signature of <code>get</code>, <code>all</code>,
    <code>search</code>, <code>first</code>, and <code>last</code> will change.</li>
</ul>
<p>The users will have 3 months to do the changes.</p>
<h3 id="implementation">Implementation<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h3>
<h4 id="on-2022-06-10">On 2022-06-10<a class="headerlink" href="#on-2022-06-10" title="Permanent link">&para;</a></h4>
<ul>
<li>Change the signature of <code>__init__</code> of the repositories to remove the <code>models</code>
    argument.</li>
<li>Change the signature of <code>get</code>, <code>all</code>, <code>search</code>, <code>first</code>, <code>last</code>, in <code>adapters/data/abstract.py</code> by:<ul>
<li>Simplifying the <code>models</code> signature from <code>OptionalModelOrModels</code> to
    <code>Optional[Type[Entity]]</code>.</li>
<li>Add the <code>model</code> argument with temporal signature <code>Optional[Type[Entity]]</code>
    in the ordered position of <code>models</code> so that users that are using
    positional arguments start using this variable. The <code>Optional</code> signature
    is there in case users are using the named argument <code>models</code> instead of
    by position, but in the end it will become <code>Type[Entity]</code>.</li>
</ul>
</li>
</ul>
<h4 id="on-2022-12-10">On 2022-12-10<a class="headerlink" href="#on-2022-12-10" title="Permanent link">&para;</a></h4>
<p>We didn't plan well the migration, as we still have an argument called <code>models</code>
when we only support one model! Now we need to do another migration in case that
users are using this named argument, instead of position arguments.</p>
<ul>
<li>
<p>Change the signature of <code>__init__</code> of the repositories to remove the
    <code>search_exception</code> transition argument.</p>
</li>
<li>
<p>Change the signature of <code>get</code>, <code>all</code>, <code>search</code>, <code>first</code>, <code>last</code>, in <code>adapters/data/abstract.py</code> by:</p>
<ul>
<li>Removing the <code>models</code> argument.</li>
<li>Simplifying the <code>model</code> argument signature to <code>Type[Entity]</code>.</li>
</ul>
</li>
<li>
<p>Change the signature of <code>load_repository</code> of <code>services.py</code> to remove <code>models</code>
    and <code>search_exception</code>.</p>
</li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2022-06-08T20:28:42+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-06-08</span>
      
    
  </small>
</div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../004-add_complex_queries/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 004: Add complex queries" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              004: Add complex queries
            </div>
          </div>
        </a>
      
      
        
        <a href="../006-drop_again_string_ids/" class="md-footer__link md-footer__link--next" aria-label="Next: 006: Drop support for string IDs" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              006: Drop support for string IDs
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>